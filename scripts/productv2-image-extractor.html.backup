<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProductV2 ì´ë¯¸ì§€ ì¶”ì¶œê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 200px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .results {
            margin-top: 20px;
        }
        .product {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            background: #f9f9f9;
        }
        .product img {
            max-width: 200px;
            height: auto;
            margin: 5px;
            border: 1px solid #ccc;
        }
        .download-link {
            display: inline-block;
            background: #28a745;
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 3px;
            margin: 2px;
            font-size: 12px;
        }
        .download-link:hover {
            background: #1e7e34;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #007bff;
            background: #f8f9fa;
        }
        .v2-info {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 10px 0;
        }
        .color-swatches {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        .color-swatch {
            width: 40px;
            height: 40px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ–¼ï¸ ProductV2 ì´ë¯¸ì§€ ì¶”ì¶œê¸°</h1>
        <div class="v2-info">
            <h3>âœ¨ ProductV2 ìµœì í™” ê¸°ëŠ¥</h3>
            <ul>
                <li>ğŸ“ <code>public/images/products/v2/</code> êµ¬ì¡°ì— ë§ëŠ” íŒŒì¼ ì €ì¥</li>
                <li>ğŸ“ <code>bookcase-{ID}-{type}.webp</code> ë„¤ì´ë° ê·œì¹™</li>
                <li>ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ìë™ ì¶”ì¶œ</li>
                <li>ğŸ Python ìŠ¤í¬ë¦½íŠ¸ ìë™ ìƒì„±</li>
            </ul>
        </div>
        
        <div class="section">
            <h3>1ë‹¨ê³„: HTML ì½”ë“œ ì…ë ¥</h3>
            <p>product-v2-example.txt ë˜ëŠ” Tylko.com ì œí’ˆ í˜ì´ì§€ì˜ HTMLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
            <textarea id="htmlInput" placeholder="ì—¬ê¸°ì— HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
            <br>
            <button onclick="extractProducts()">ğŸ” ì œí’ˆ ì •ë³´ ì¶”ì¶œ</button>
            <button onclick="loadSampleData()">ğŸ“„ ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ</button>
            <button onclick="clearAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="section">
            <h3>2ë‹¨ê³„: ì¶”ì¶œ ê²°ê³¼</h3>
            <div id="results"></div>
        </div>
        
        <div class="section">
            <h3>3ë‹¨ê³„: ProductV2 ë‹¤ìš´ë¡œë“œ</h3>
            <button onclick="downloadV2JSON()">ğŸ“„ ProductV2 JSON</button>
            <button onclick="downloadV2CSV()">ğŸ“Š ProductV2 CSV</button>
            <button onclick="generateV2DownloadScript()">ğŸ V2 Python ìŠ¤í¬ë¦½íŠ¸</button>
            <button onclick="generateBrowserDownloadPage()">ğŸŒ ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ í˜ì´ì§€</button>
            <button onclick="generatePowerShellScript()">ğŸ’» PowerShell ìŠ¤í¬ë¦½íŠ¸ (ì¶”ì²œ!)</button>
            <button onclick="downloadAsZip()" style="background: #28a745;">ğŸ“¦ ZIP íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ (í´ë” êµ¬ì¡° í¬í•¨)</button>
            <button onclick="generateDirectDownloadLinks()" style="background: #17a2b8;">ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±</button>
            <button onclick="generateConsoleScript()" style="background: #6f42c1;">ğŸ¤– ë¸Œë¼ìš°ì € ì½˜ì†” ìŠ¤í¬ë¦½íŠ¸ ìƒì„±</button>
            <button onclick="generateColorSwatchScript()">ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ìŠ¤í¬ë¦½íŠ¸</button>
        </div>
    </div>

    <script>
        let extractedProducts = [];

        function loadSampleData() {
            // ì‚¬ìš©ìê°€ ì œê³µí•œ ì‹¤ì œ product-v2-example.txt HTML ìƒ˜í”Œ
            const sampleHTML = `<div id="plp" class="md-max:px-0 grid-container mt-12"><ul class="grid grid-cols-2 gap-8 md:gap-16 lg:grid-cols-4" data-section="grid-v2-board"><!--[--><li data-testid="product-card"><figure class="flex flex-col h-full relative group/plp-product-card transition-all basic-transition hover:shadow-plp-product-card bg-white" data-index="0" preview="https://media.tylko.com/media/catalogue/catalogue_entry/2024/02/unreal_render_tasks/unreal_50.webp"><a href="/en-ot/furniture/bookcase/3516465,j,tall-slim-white-bookcase-with-doors-103x243x24cm" class="custom" data-testid="product-card-link"><!--[--><!--]--><!--[--><div class="relative w-full overflow-hidden aspect-square"><img src="https://media.tylko.com/media/gallery/furniture_image/2022/05/Living_room_08_living-room-Bookcase_EAPgDsY.jpg" alt="Bookcase in White with Doors" loading="eager" fetchpriority="high" class="object-cover absolute top-0 left-0" style="min-width:calc(100% + 1px);" data-testid="product-card-image-instagrid"><img src="https://media.tylko.com/media/catalogue/catalogue_entry/2024/02/unreal_render_tasks/unreal_50.webp" alt="Bookcase in White with Doors" loading="lazy" class="block group-hover/plp-product-card:opacity-100 group-hover/plp-product-card:scale-100 absolute inset-0 duration-500 ease-in-out opacity-0 transition-all z-1 transform scale-[1.04]" fetchpriority="low" style="min-width:calc(100% + 1px);" data-testid="product-card-image"><div class="semibold-12 px-8 py-2 rounded-4 absolute top-8 left-8 md:top-12 md:left-16 z-2 flex py-2 px-8" style="color:#FFFF66;background-color:#FF3C00;" data-testid="product-card-badge"><!--[-->-40% <span class="ml-4">&amp;</span><span class="ml-4">Free delivery</span><!--]--></div><!----><button class="outline-none ty-btn-icon configure-yours ty-btn-icon--m ty-btn-filled ty-btn-filled--dark hover:bg-white absolute bottom-8 lg:bottom-16 left-1/2 min-w-max -translate-x-1/2 translate-y-64 group-hover/plp-product-card:translate-y-0 md-max:translate-y-0 md-max:ty-btn-icon"></div></a><div class="flex flex-col justify-between h-full md:mt-4"><a href="/en-ot/furniture/bookcase/3516465,j,tall-slim-white-bookcase-with-doors-103x243x24cm" class="custom flex flex-col flex-1 p-8 md:p-16"><div class="flex flex-col flex-1"><p class="semibold-12 uppercase mb-8 md:mb-12 text-[#BE7958]" data-testid="product-card-label">Top seller</p><p class="semibold-14 text-neutral-900" data-testid="product-card-furniture-type">Original Modern</p><h2 class="line-clamp-1 normal-14 md:mt-2 text-neutral-750" data-testid="product-card-furniture-description">Bookcase in White with Doors</h2><h3 class="normal-14 md:mt-2 text-neutral-750" data-testid="product-card-furniture-size">103 x 243 cm</h3></div><aside class="semibold-16 text-neutral-900 mt-8 md:mt-12 text-neutral-900"><span class="semibold-16 text-orange mr-4" data-testid="product-card-price-discount">â‚¬1281</span><span class="normal-16 line-through text-neutral-900" data-testid="product-card-price">â‚¬2135</span></aside></a></div></figure></li></ul></div>`;
            
            document.getElementById('htmlInput').value = sampleHTML;
        }

        function extractProducts() {
            const htmlContent = document.getElementById('htmlInput').value;
            if (!htmlContent.trim()) {
                alert('HTML ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');
            
            // ë””ë²„ê¹… ë¡œê·¸
            console.log('ğŸ” HTML íŒŒì‹± ì‹œì‘...');
            console.log('ì „ì²´ DOM:', doc.body);
            
            // ë‹¤ì–‘í•œ ì„ íƒì ì‹œë„
            let productCards = doc.querySelectorAll('[data-testid="product-card"]');
            console.log('data-testid="product-card" ì°¾ìŒ:', productCards.length);
            
            if (productCards.length === 0) {
                productCards = doc.querySelectorAll('li[data-testid="product-card"]');
                console.log('li[data-testid="product-card"] ì°¾ìŒ:', productCards.length);
            }
            
            if (productCards.length === 0) {
                productCards = doc.querySelectorAll('li figure');
                console.log('li figure ì°¾ìŒ:', productCards.length);
            }
            
            if (productCards.length === 0) {
                // ì§ì ‘ HTML í…ìŠ¤íŠ¸ì—ì„œ ì°¾ê¸°
                const matches = htmlContent.match(/data-testid="product-card"/g);
                console.log('HTML í…ìŠ¤íŠ¸ì—ì„œ product-card ê°œìˆ˜:', matches ? matches.length : 0);
                
                // figure íƒœê·¸ë¡œ ë‹¤ì‹œ ì‹œë„
                productCards = doc.querySelectorAll('figure.flex.flex-col');
                console.log('figure.flex.flex-col ì°¾ìŒ:', productCards.length);
            }
            
            extractedProducts = [];

            productCards.forEach((card, index) => {
                // ì œí’ˆëª… ë¨¼ì € ì¶”ì¶œ
                const nameElem = card.querySelector('[data-testid="product-card-furniture-description"]');
                const productName = nameElem ? nameElem.textContent.trim() : `Product ${index + 1}`;
                
                const product = {
                    id: generateProductFilename(productName, index),
                    name: productName,
                    furnitureType: '',
                    exactDimensions: '',
                    mainImage: '',
                    instagramImage: '',
                    colorVariants: [],
                    discountPrice: '',
                    originalPrice: '',
                    productUrl: '',
                    labels: [],
                    badges: []
                };

                // ê°€êµ¬ íƒ€ì…
                const typeElem = card.querySelector('[data-testid="product-card-furniture-type"]');
                if (typeElem) product.furnitureType = typeElem.textContent.trim();

                // ì •í™•í•œ ì¹˜ìˆ˜
                const sizeElem = card.querySelector('[data-testid="product-card-furniture-size"]');
                if (sizeElem) product.exactDimensions = sizeElem.textContent.trim();

                // ë©”ì¸ ì´ë¯¸ì§€ (ê¸°ë³¸ í‘œì‹œë˜ëŠ” ì œí’ˆ ì´ë¯¸ì§€)
                const mainImg = card.querySelector('[data-testid="product-card-image-instagrid"]');
                if (mainImg) product.mainImage = mainImg.src || '';

                // í˜¸ë²„ ì´ë¯¸ì§€ (ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ í‘œì‹œë˜ëŠ” ì´ë¯¸ì§€) 
                const hoverImg = card.querySelector('[data-testid="product-card-image"]');
                if (hoverImg) product.instagramImage = hoverImg.src || '';

                // ì¼ë°˜ì ì¸ ê°€êµ¬ ìƒ‰ìƒ ìˆœì„œ (Tylko.com íŒ¨í„´ ê¸°ë°˜)
                const COMMON_FURNITURE_COLORS = [
                    'White', 'Grey', 'Brown', 'Black', 'Green', 
                    'Moss Green', 'Light Wood', 'Dark Wood', 
                    'Beige', 'Sand', 'Pink', 'Blue'
                ];
                
                // ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ë“¤ ì¶”ì¶œ
                const colorSwatches = card.querySelectorAll('img[src*="thumbnail"], .swatch, [class*="swatch"]');
                colorSwatches.forEach((swatch, swatchIndex) => {
                    if (swatch.src && swatch.src.includes('thumbnail')) {
                        let colorName;
                        
                        // 1ìˆœìœ„: ì²« ë²ˆì§¸ ìŠ¤ì™€ì¹˜ëŠ” ì œí’ˆëª…ì—ì„œ ìƒ‰ìƒ ì¶”ì¶œ
                        if (swatchIndex === 0) {
                            colorName = extractColorFromProductName(productName);
                        }
                        
                        // 2ìˆœìœ„: URLì—ì„œ ìƒ‰ìƒëª… ì¶”ì¶œ ì‹œë„
                        if (!colorName) {
                            colorName = extractColorFromUrl(swatch.src);
                        }
                        
                        // 3ìˆœìœ„: ì¼ë°˜ì ì¸ ê°€êµ¬ ìƒ‰ìƒ ìˆœì„œ ì ìš©
                        if (!colorName) {
                            colorName = COMMON_FURNITURE_COLORS[swatchIndex] || `Color-${swatchIndex + 1}`;
                        }
                        
                        product.colorVariants.push({
                            id: `${product.id}-${colorName.toLowerCase().replace(/\s+/g, '-')}`,
                            name: colorName,
                            thumbnail: swatch.src,
                            mainImage: product.mainImage,
                            instagramImage: product.instagramImage,
                            isDefault: swatchIndex === 0,
                            isSelected: swatchIndex === 0,
                            availability: 'in_stock'
                        });
                    }
                });

                // ê°€ê²© ì •ë³´
                const discountElem = card.querySelector('[data-testid="product-card-price-discount"]');
                if (discountElem) product.discountPrice = discountElem.textContent.trim();

                const originalElem = card.querySelector('[data-testid="product-card-price"]');
                if (originalElem) product.originalPrice = originalElem.textContent.trim();

                // ì œí’ˆ URL
                const linkElem = card.querySelector('[data-testid="product-card-link"]');
                if (linkElem) product.productUrl = linkElem.href || '';

                // ë¼ë²¨ë“¤
                const labelElem = card.querySelector('[data-testid="product-card-label"]');
                if (labelElem) {
                    product.labels.push({
                        text: labelElem.textContent.trim(),
                        color: '#BE7958'
                    });
                }

                // ë°°ì§€ ìƒì„± (í• ì¸ ì •ë³´ ê¸°ë°˜)
                if (product.discountPrice && product.originalPrice) {
                    product.badges.push({
                        type: 'discount',
                        text: '-40% & Free delivery',
                        style: {
                            backgroundColor: '#FF3C00',
                            color: '#FFFF66'
                        },
                        priority: 1
                    });
                }

                extractedProducts.push(product);
            });

            console.log('âœ… ì¶”ì¶œ ì™„ë£Œ:', extractedProducts.length + 'ê°œ ì œí’ˆ');
            console.log('ì¶”ì¶œëœ ì œí’ˆë“¤:', extractedProducts);
            
            if (extractedProducts.length === 0) {
                alert('ì œí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš” (F12)');
            }
            
            displayResults();
        }

        function extractColorFromUrl(url) {
            // URLì—ì„œ ìƒ‰ìƒëª… ì¶”ì¶œ ì‹œë„
            const colorKeywords = ['white', 'grey', 'gray', 'brown', 'black', 'green', 'blue', 'red', 'beige', 'sand', 'pink', 'moss'];
            const urlLower = url.toLowerCase();
            
            for (const color of colorKeywords) {
                if (urlLower.includes(color)) {
                    return color.charAt(0).toUpperCase() + color.slice(1);
                }
            }
            
            // URLì—ì„œ ìˆ«ì ID ì¶”ì¶œ (unreal_50 â†’ Color-50)
            const numberMatch = url.match(/unreal_(\d+)/);
            if (numberMatch) {
                return `Color-${numberMatch[1]}`;
            }
            
            return null;
        }
        
        function extractColorFromProductName(productName) {
            // ì œí’ˆëª…ì—ì„œ ìƒ‰ìƒ ì¶”ì¶œ ("Bookcase in White with Doors" â†’ "White")
            if (!productName) return null;
            
            const colorKeywords = [
                'white', 'grey', 'gray', 'brown', 'black', 'green', 'blue', 'red', 
                'beige', 'sand', 'pink', 'moss green', 'moss', 'light wood', 'dark wood',
                'navy', 'cream', 'ivory', 'charcoal', 'oak', 'walnut'
            ];
            
            const nameLower = productName.toLowerCase();
            
            // ê¸´ í‚¤ì›Œë“œë¶€í„° ë¨¼ì € í™•ì¸ (ì˜ˆ: "moss green" before "moss")
            const sortedKeywords = colorKeywords.sort((a, b) => b.length - a.length);
            
            for (const color of sortedKeywords) {
                if (nameLower.includes(color)) {
                    return color.split(' ').map(word => 
                        word.charAt(0).toUpperCase() + word.slice(1)
                    ).join(' ');
                }
            }
            
            return null;
        }

        function generateProductFilename(productName, index = 0) {
            if (!productName || productName.trim() === '') {
                return `bookcase-${String(index + 1).padStart(2, '0')}`;
            }
            
            // "Bookcase in White with Doors" â†’ "bookcase-white-doors"
            let filename = productName
                .toLowerCase()
                .replace(/\s+in\s+/gi, '-')      // " in " â†’ "-"
                .replace(/\s+with\s+/gi, '-')    // " with " â†’ "-"  
                .replace(/\s+and\s+/gi, '-')     // " and " â†’ "-"
                .replace(/[^a-z0-9\s-]/gi, '')   // íŠ¹ìˆ˜ë¬¸ì ì œê±°
                .replace(/\s+/g, '-')            // ê³µë°± â†’ "-"
                .replace(/-+/g, '-')             // ì—°ì† í•˜ì´í”ˆ â†’ ë‹¨ì¼ í•˜ì´í”ˆ
                .replace(/^-|-$/g, '');          // ì•ë’¤ í•˜ì´í”ˆ ì œê±°
            
            // ë„ˆë¬´ ê¸¸ë©´ ì¤„ì´ê¸° (ìµœëŒ€ 30ì)
            if (filename.length > 30) {
                filename = filename.substring(0, 30).replace(/-$/, '');
            }
            
            // ë¹ˆ ê²°ê³¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
            if (!filename) {
                return `bookcase-${String(index + 1).padStart(2, '0')}`;
            }
            
            return filename;
        }

        function displayResults() {
            const resultsDiv = document.getElementById('results');
            if (extractedProducts.length === 0) {
                resultsDiv.innerHTML = '<p>ì¶”ì¶œëœ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            let html = `<h4>ğŸ¯ ì´ ${extractedProducts.length}ê°œ ProductV2 ë°ì´í„° ì¶”ì¶œ ì™„ë£Œ</h4>`;
            
            extractedProducts.forEach((product, index) => {
                html += `
                <div class="product">
                    <h5>ğŸ“¦ ${product.id}: ${product.name || 'N/A'}</h5>
                    <p><strong>ğŸ·ï¸ ê°€êµ¬ íƒ€ì…:</strong> ${product.furnitureType || 'N/A'}</p>
                    <p><strong>ğŸ“ ì •í™•í•œ ì¹˜ìˆ˜:</strong> ${product.exactDimensions || 'N/A'}</p>
                    <p><strong>ğŸ’° ê°€ê²©:</strong> ${product.discountPrice || 'N/A'} <del>${product.originalPrice || ''}</del></p>
                    <p><strong>ğŸ† ë¼ë²¨:</strong> ${product.labels.map(l => l.text).join(', ') || 'N/A'}</p>
                    
                    <div>
                        <strong>ğŸ–¼ï¸ V2 ì´ë¯¸ì§€ë“¤:</strong><br>
                        ${product.mainImage ? `
                            <div>
                                <img src="${product.mainImage}" alt="ë©”ì¸ ì´ë¯¸ì§€" loading="lazy">
                                <br><a href="${product.mainImage}" class="download-link" target="_blank">Main ë‹¤ìš´ë¡œë“œ</a>
                                <small>â†’ <code>${product.id}-main.webp</code></small>
                            </div>
                        ` : ''}
                        
                        ${product.instagramImage ? `
                            <div>
                                <img src="${product.instagramImage}" alt="í˜¸ë²„ ì´ë¯¸ì§€" loading="lazy">
                                <br><a href="${product.instagramImage}" class="download-link" target="_blank">Hover ë‹¤ìš´ë¡œë“œ</a>
                                <small>â†’ <code>${product.id}-hover.webp</code></small>
                            </div>
                        ` : ''}
                        
                        ${product.colorVariants.length > 0 ? `
                            <div>
                                <p><strong>ğŸ¨ ìƒ‰ìƒ ë³€í˜• (${product.colorVariants.length}ê°œ):</strong></p>
                                <div class="color-swatches">
                                    ${product.colorVariants.map((variant, i) => `
                                        <div>
                                            <img src="${variant.thumbnail}" alt="${variant.name}" class="color-swatch">
                                            <br><small>${variant.name}</small>
                                            <br><a href="${variant.thumbnail}" class="download-link" target="_blank">ìŠ¤ì™€ì¹˜</a>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>`;
            });

            resultsDiv.innerHTML = html;
        }

        function downloadV2JSON() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const dataStr = JSON.stringify({
                version: '2.0',
                extractedAt: new Date().toISOString(),
                totalProducts: extractedProducts.length,
                products: extractedProducts
            }, null, 2);
            
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'productv2-data.json';
            link.click();
        }

        function downloadV2CSV() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            let csv = 'ID,Name,FurnitureType,ExactDimensions,DiscountPrice,OriginalPrice,MainImageURL,InstagramImageURL,ColorVariantsCount,Labels\n';
            
            extractedProducts.forEach(product => {
                csv += `"${product.id}","${product.name}","${product.furnitureType}","${product.exactDimensions}","${product.discountPrice}","${product.originalPrice}","${product.mainImage}","${product.instagramImage}",${product.colorVariants.length},"${product.labels.map(l => l.text).join('; ')}"\n`;
            });

            const dataBlob = new Blob([csv], {type: 'text/csv'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'productv2-data.csv';
            link.click();
        }

        function generateV2DownloadScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            let script = `#!/usr/bin/env python3
# ğŸ–¼ï¸ ProductV2 ìë™ í´ë” êµ¬ì¡° + ì¼ê´„ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
# ì œí’ˆë³„ í´ë” ìƒì„± ë° ì²´ê³„ì  ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

import requests
import os
import time
from pathlib import Path
from urllib.parse import urlparse

def download_image(url, filepath, description=""):
    """ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì €ì¥í•©ë‹ˆë‹¤."""
    try:
        print(f"ğŸ“¥ {description}: {os.path.basename(filepath)}")
        
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://tylko.com/'
        }
        
        response = requests.get(url, headers=headers, stream=True, timeout=30)
        response.raise_for_status()
        
        # ë””ë ‰í† ë¦¬ ìƒì„±
        os.makedirs(os.path.dirname(filepath), exist_ok=True)
        
        with open(filepath, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                if chunk:
                    f.write(chunk)
        
        print(f"âœ… ì €ì¥ë¨: {filepath}")
        return True
        
    except Exception as e:
        print(f"âŒ ì‹¤íŒ¨ {description}: {e}")
        return False

def main():
    """ì œí’ˆë³„ í´ë” êµ¬ì¡°ë¡œ ì´ë¯¸ì§€ ì¼ê´„ ë‹¤ìš´ë¡œë“œ"""
    
    base_path = Path("downloads")
    base_path.mkdir(exist_ok=True)
    
    success_count = 0
    total_count = 0
    
    print("ğŸš€ ProductV2 ìë™ í´ë” êµ¬ì¡° + ì¼ê´„ ë‹¤ìš´ë¡œë“œ ì‹œì‘...")
    print(f"ğŸ“ ì €ì¥ ìœ„ì¹˜: {base_path.absolute()}")
    print(f"ğŸ“¦ ì´ ${extractedProducts.length}ê°œ ì œí’ˆ")
    print()

`;

            extractedProducts.forEach((product, index) => {
                script += `    # ğŸ“¦ ì œí’ˆ ${index + 1}: ${product.name}\n`;
                script += `    print("\\nğŸ“¦ [${index + 1}/${extractedProducts.length}] ${product.name}")\n`;
                script += `    \n`;
                script += `    # ì œí’ˆë³„ í´ë” ìƒì„±\n`;
                script += `    product_folder = base_path / "${product.id}"\n`;
                script += `    (product_folder / "main").mkdir(parents=True, exist_ok=True)\n`;
                script += `    (product_folder / "hover").mkdir(parents=True, exist_ok=True)\n`;
                script += `    (product_folder / "colors").mkdir(parents=True, exist_ok=True)\n`;
                script += `    \n`;
                
                // ë©”ì¸ ì´ë¯¸ì§€
                if (product.mainImage) {
                    script += `    # ë©”ì¸ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ\n`;
                    script += `    total_count += 1\n`;
                    script += `    if download_image("${product.mainImage}", product_folder / "main" / "${product.id}-main.webp", "ë©”ì¸ ì´ë¯¸ì§€"):\n`;
                    script += `        success_count += 1\n`;
                    script += `    time.sleep(0.3)\n\n`;
                }
                
                // í˜¸ë²„ ì´ë¯¸ì§€
                if (product.instagramImage) {
                    script += `    # í˜¸ë²„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ\n`;
                    script += `    total_count += 1\n`;
                    script += `    if download_image("${product.instagramImage}", product_folder / "hover" / "${product.id}-hover.webp", "í˜¸ë²„ ì´ë¯¸ì§€"):\n`;
                    script += `        success_count += 1\n`;
                    script += `    time.sleep(0.3)\n\n`;
                }
                
                // ìƒ‰ìƒ ë³€í˜• ì´ë¯¸ì§€ë“¤
                if (product.colorVariants && product.colorVariants.length > 0) {
                    script += `    # ìƒ‰ìƒ ë³€í˜• ì´ë¯¸ì§€ë“¤ ë‹¤ìš´ë¡œë“œ (${product.colorVariants.length}ê°œ)\n`;
                    product.colorVariants.forEach((variant, colorIndex) => {
                        if (variant.thumbnail) {
                            const safeColorName = variant.name.toLowerCase().replace(/[^a-z0-9]/g, '-');
                            script += `    total_count += 1\n`;
                            script += `    if download_image("${variant.thumbnail}", product_folder / "colors" / "${product.id}-${safeColorName}.webp", "${variant.name} ìƒ‰ìƒ"):\n`;
                            script += `        success_count += 1\n`;
                            script += `    time.sleep(0.2)\n`;
                        }
                    });
                    script += `\n`;
                }
                
                script += `    print(f"âœ… ${product.name} ì™„ë£Œ\\n")\n\n`;
            });

            script += `
    print()
    print("ğŸ‰ ì „ì²´ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!")
    print(f"ğŸ“Š í†µê³„: ì„±ê³µ {success_count}/{total_count} (ì‹¤íŒ¨: {total_count - success_count})")
    print(f"ğŸ“ ì €ì¥ ìœ„ì¹˜: {base_path.absolute()}")
    print()
    
    # ë‹¤ìš´ë¡œë“œëœ í´ë” êµ¬ì¡° í‘œì‹œ
    print("ğŸ“‚ ë‹¤ìš´ë¡œë“œëœ í´ë” êµ¬ì¡°:")
    for product_folder in sorted(base_path.glob("*")):
        if product_folder.is_dir():
            print(f"â”œâ”€â”€ ğŸ“ {product_folder.name}/")
            for subfolder in ["main", "hover", "colors"]:
                subfolder_path = product_folder / subfolder
                if subfolder_path.exists():
                    file_count = len(list(subfolder_path.glob("*.webp")))
                    print(f"â”‚   â”œâ”€â”€ ğŸ“ {subfolder}/ ({file_count}ê°œ íŒŒì¼)")
    
    print()
    print("ğŸ¯ ë‹¤ìŒ ë‹¨ê³„:")
    print("1. downloads í´ë”ì—ì„œ public/images/products/v2/ë¡œ íŒŒì¼ ì´ë™")
    print("2. src/data/migration/imageMapping.ts ì—…ë°ì´íŠ¸") 
    print("3. ProductV2 ì»´í¬ë„ŒíŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸")
    print("4. í•„ìš”ì‹œ ìƒ‰ìƒëª… ìˆ˜ë™ ë³´ì •")

if __name__ == "__main__":
    main()
`;

            const dataBlob = new Blob([script], {type: 'text/plain'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'download_productv2_images.py';
            link.click();
        }

        function generateBrowserDownloadPage() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const htmlContent = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ğŸ–¼ï¸ ProductV2 ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
        }
        .product-item { 
            margin: 20px 0; 
            padding: 20px; 
            border: 2px solid #e0e0e0; 
            border-radius: 12px; 
            background: #f9f9f9;
            transition: all 0.3s ease;
        }
        .product-item:hover {
            border-color: #007bff;
            box-shadow: 0 4px 12px rgba(0,123,255,0.15);
        }
        .download-btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 12px 20px;
            text-decoration: none;
            border-radius: 8px;
            margin: 6px;
            display: inline-block;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,123,255,0.3);
        }
        .download-btn:hover { 
            background: linear-gradient(135deg, #0056b3, #003d82);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.4);
        }
        .download-btn.main { background: linear-gradient(135deg, #28a745, #1e7e34); }
        .download-btn.hover { background: linear-gradient(135deg, #ffc107, #e0a800); }
        .download-btn.color { background: linear-gradient(135deg, #6f42c1, #5a32a3); }
        .progress { 
            margin: 20px 0; 
            padding: 20px; 
            background: #e8f4fd; 
            border-radius: 8px; 
            border-left: 4px solid #007bff;
        }
        .stats {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        h3 { color: #495057; margin-bottom: 15px; }
        .batch-download {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ–¼ï¸ ProductV2 ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ</h1>
        
        <div class="stats">
            <strong>ğŸ“Š ì¶”ì¶œëœ ë°ì´í„°:</strong> ${extractedProducts.length}ê°œ ì œí’ˆ, ì´ ${extractedProducts.reduce((total, p) => total + (p.colorVariants?.length || 0), 0)}ê°œ ìƒ‰ìƒ ë³€í˜•
        </div>
        
        <div class="batch-download">
            <h3>ğŸš€ ì¼ê´„ ë‹¤ìš´ë¡œë“œ ë°©ë²•</h3>
            <p><strong>ë°©ë²• 1: PowerShell ìŠ¤í¬ë¦½íŠ¸</strong> (ì¶”ì²œ!)</p>
            <ol style="text-align: left; margin: 10px auto; max-width: 600px;">
                <li>download-images.ps1 íŒŒì¼ ìƒì„±ë¨</li>
                <li>PowerShell ì—´ê¸° (ê´€ë¦¬ì ê¶Œí•œ)</li>
                <li>Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</li>
                <li>cd scripts â†’ ./download-images.ps1 ì‹¤í–‰</li>
            </ol>
            <p><strong>ë°©ë²• 2: ë¸Œë¼ìš°ì € í™•ì¥</strong></p>
            <p>"DownThemAll" ë˜ëŠ” "Bulk Image Downloader" ì„¤ì¹˜ í›„ ì¼ê´„ ë‹¤ìš´ë¡œë“œ</p>
            <p><strong>ë°©ë²• 3: ìˆ˜ë™</strong></p>
            <p>ê° ë§í¬ ìš°í´ë¦­ â†’ "ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë§í¬ ì €ì¥" â†’ ì ì ˆí•œ í´ë”ì— ì €ì¥</p>
        </div>

${extractedProducts.map((product, index) => `
        <div class="product-item">
            <h3>ğŸ“¦ ${product.name || `ì œí’ˆ ${index + 1}`}</h3>
            <p><strong>ID:</strong> ${product.id} | <strong>íƒ€ì…:</strong> ${product.furnitureType || 'N/A'} | <strong>í¬ê¸°:</strong> ${product.exactDimensions || 'N/A'}</p>
            
            <div>
                ${product.mainImage ? `<a href="${product.mainImage}" class="download-btn main" download="${product.id}-main.webp">ğŸ“· ë©”ì¸ ì´ë¯¸ì§€</a>` : ''}
                ${product.instagramImage ? `<a href="${product.instagramImage}" class="download-btn hover" download="${product.id}-hover.webp">ğŸ–¼ï¸ í˜¸ë²„ ì´ë¯¸ì§€</a>` : ''}
                ${product.colorVariants?.map(color => {
                    const safeColorName = color.name.toLowerCase().replace(/[^a-z0-9]/g, '-');
                    return `<a href="${color.thumbnail}" class="download-btn color" download="${product.id}-${safeColorName}.webp">ğŸ¨ ${color.name}</a>`;
                }).join('') || ''}
            </div>
            
            <div style="margin-top: 15px; font-size: 12px; color: #666;">
                <strong>í´ë” êµ¬ì¡°:</strong> downloads/${product.id}/main/, downloads/${product.id}/hover/, downloads/${product.id}/colors/
            </div>
        </div>
`).join('')}

        <div class="progress">
            <h3>ğŸ“ ê¶Œì¥ í´ë” êµ¬ì¡°</h3>
            <pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;">
downloads/
${extractedProducts.map(p => `â”œâ”€â”€ ${p.id}/
â”‚   â”œâ”€â”€ main/     # ${p.id}-main.webp
â”‚   â”œâ”€â”€ hover/    # ${p.id}-hover.webp
â”‚   â””â”€â”€ colors/   # ${p.id}-white.webp, ${p.id}-grey.webp...`).join('\n')}
            </pre>
        </div>
        
        <div class="progress">
            <p><strong>âœ… ë‹¤ìš´ë¡œë“œ ì™„ë£Œ í›„:</strong></p>
            <ol>
                <li>public/images/products/v2/ í´ë”ì— ì •ë¦¬</li>
                <li>src/data/migration/imageMapping.ts ì—…ë°ì´íŠ¸</li>
                <li>ProductV2 ì»´í¬ë„ŒíŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸</li>
            </ol>
        </div>
    </div>

    <script>
        // ë‹¤ìš´ë¡œë“œ ì§„í–‰ìƒí™© ì¶”ì  (ì˜µì…˜)
        document.querySelectorAll('.download-btn').forEach(link => {
            link.addEventListener('click', function() {
                this.style.background = 'linear-gradient(135deg, #28a745, #1e7e34)';
                this.innerHTML = 'âœ… ' + this.innerHTML.replace('ğŸ“· ', '').replace('ğŸ–¼ï¸ ', '').replace('ğŸ¨ ', '');
            });
        });
        
        console.log('ProductV2 ë‹¤ìš´ë¡œë“œ í˜ì´ì§€ ì¤€ë¹„ ì™„ë£Œ!');
        console.log('ì´ \${extractedProducts.length}ê°œ ì œí’ˆ, \${extractedProducts.reduce((total, p) => total + (p.colorVariants?.length || 0) + 2, 0)}ê°œ ì´ë¯¸ì§€');
    </` + `script>
</body>
</html>`;

            const dataBlob = new Blob([htmlContent], {type: 'text/html'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'productv2-browser-download.html';
            link.click();
        }

        function generateColorSwatchScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ëª¨ë“  ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ URL ìˆ˜ì§‘
            const allSwatches = new Set();
            extractedProducts.forEach(product => {
                product.colorVariants.forEach(variant => {
                    if (variant.thumbnail) {
                        allSwatches.add(variant.thumbnail);
                    }
                });
            });

            let script = `#!/usr/bin/env python3
# ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸

import requests
import os
import time
from pathlib import Path

def download_swatch(url, filename):
    try:
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://tylko.com/'
        }
        
        response = requests.get(url, headers=headers, stream=True, timeout=30)
        response.raise_for_status()
        
        filepath = Path("public/images/products/v2/thumbnail") / filename
        os.makedirs(filepath.parent, exist_ok=True)
        
        with open(filepath, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                if chunk:
                    f.write(chunk)
        
        print(f"âœ… ìŠ¤ì™€ì¹˜ ë‹¤ìš´ë¡œë“œ: {filename}")
        return True
        
    except Exception as e:
        print(f"âŒ ì‹¤íŒ¨ {filename}: {e}")
        return False

def main():
    print("ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ë‹¤ìš´ë¡œë“œ...")
    print()
    
`;

            Array.from(allSwatches).forEach((swatchUrl, index) => {
                const colorName = extractColorFromUrl(swatchUrl) || `swatch-${index + 1}`;
                const filename = `swatch-${colorName.toLowerCase().replace(/\s+/g, '-')}.webp`;
                
                script += `    download_swatch("${swatchUrl}", "${filename}")\n`;
                script += `    time.sleep(0.3)\n\n`;
            });

            script += `    print("ğŸ¯ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!")

if __name__ == "__main__":
    main()
`;

            const dataBlob = new Blob([script], {type: 'text/plain'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'download_color_swatches.py';
            link.click();
        }

        function generatePowerShellScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆì„ ì¶”ì¶œí•´ì£¼ì„¸ìš”!');
                return;
            }

            let script = `# PowerShell ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
# Cloudflare ìš°íšŒ + í´ë” êµ¬ì¡° ìë™ ìƒì„±

# ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
function Download-Image {
    param(
        [string]$url,
        [string]$outputPath
    )
    
    try {
        # í´ë” ìƒì„±
        $folder = Split-Path $outputPath -Parent
        if (!(Test-Path $folder)) {
            New-Item -ItemType Directory -Path $folder -Force | Out-Null
        }
        
        # ë‹¤ìš´ë¡œë“œ
        $headers = @{
            "User-Agent" = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
            "Referer" = "https://tylko.com/"
            "Accept" = "image/webp,image/apng,image/*,*/*;q=0.8"
        }
        
        Write-Host "ğŸ“¥ ë‹¤ìš´ë¡œë“œ ì¤‘: $outputPath" -ForegroundColor Yellow
        Invoke-WebRequest -Uri $url -OutFile $outputPath -Headers $headers -UseBasicParsing
        Write-Host "âœ… ì™„ë£Œ: $outputPath" -ForegroundColor Green
        return $true
    }
    catch {
        Write-Host "âŒ ì‹¤íŒ¨: $outputPath - $_" -ForegroundColor Red
        return $false
    }
}

# ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
Write-Host "ğŸš€ ProductV2 ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì‹œì‘" -ForegroundColor Cyan
Write-Host "=" * 50

$baseFolder = "public\\images\\products\\v2"
$successCount = 0
$totalCount = 0

`;

            // ê° ì œí’ˆë³„ ë‹¤ìš´ë¡œë“œ ì½”ë“œ ìƒì„±
            extractedProducts.forEach((product, index) => {
                const productNumber = index + 1;
                script += `# ì œí’ˆ ${productNumber}: ${product.name}
Write-Host "\`nğŸ“¦ ì œí’ˆ ${productNumber}: ${product.name}" -ForegroundColor Magenta
$product${productNumber} = "${product.id}"

`;

                // ë©”ì¸ ì´ë¯¸ì§€
                if (product.mainImage) {
                    script += `$totalCount++
if (Download-Image "${product.mainImage}" "$baseFolder\\$product${productNumber}\\main\\$product${productNumber}-main.jpg") {
    $successCount++
}
Start-Sleep -Milliseconds 500

`;
                }

                // í˜¸ë²„ ì´ë¯¸ì§€ (Instagram ì´ë¯¸ì§€)
                if (product.instagramImage) {
                    const extension = product.instagramImage.includes('.webp') ? 'webp' : 'jpg';
                    script += `$totalCount++
if (Download-Image "${product.instagramImage}" "$baseFolder\\$product${productNumber}\\hover\\$product${productNumber}-hover.${extension}") {
    $successCount++
}
Start-Sleep -Milliseconds 500

`;
                }

                // ìƒ‰ìƒ ë³€í˜•ë“¤
                if (product.colorVariants && product.colorVariants.length > 0) {
                    script += `# ìƒ‰ìƒ ë³€í˜•ë“¤
$colors${productNumber} = @(
`;
                    product.colorVariants.forEach((color, colorIndex) => {
                        const isLastColor = colorIndex === product.colorVariants.length - 1;
                        const comma = isLastColor ? '' : ',';
                        script += `    @{name="${color.name.toLowerCase()}"; url="${color.thumbnail}"}${comma}
`;
                    });
                    script += `)

foreach ($color in $colors${productNumber}) {
    $totalCount++
    $extension = if ($color.url -like "*.webp") { "webp" } else { "jpg" }
    if (Download-Image $color.url "$baseFolder\\$product${productNumber}\\colors\\$product${productNumber}-$($color.name).$extension") {
        $successCount++
    }
    Start-Sleep -Milliseconds 300
}

`;
                }
            });

            // ìŠ¤í¬ë¦½íŠ¸ ë§ˆë¬´ë¦¬
            script += `Write-Host "\`n" 
Write-Host "=" * 50
Write-Host "ğŸ‰ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!" -ForegroundColor Green
Write-Host "ğŸ“Š ì„±ê³µ: $successCount/$totalCount" -ForegroundColor Cyan
Write-Host "ğŸ“ ì €ì¥ ìœ„ì¹˜: $(Get-Location)\\$baseFolder" -ForegroundColor Yellow

# í´ë” êµ¬ì¡° í‘œì‹œ
Write-Host "\`nğŸ“‚ ìƒì„±ëœ í´ë” êµ¬ì¡°:" -ForegroundColor Magenta
if (Test-Path $baseFolder) {
    Get-ChildItem -Path $baseFolder -Recurse -Directory | ForEach-Object {
        $indent = "  " * ($_.FullName.Split('\\').Count - (Get-Location).Path.Split('\\').Count - 3)
        Write-Host "$indentğŸ“ $($_.Name)"
    }
}

Write-Host "\`nâœ… ì™„ë£Œ! ë‹¤ìŒ ë‹¨ê³„:" -ForegroundColor Green
Write-Host "1. ì´ë¯¸ì§€ í´ë” í™•ì¸: public/images/products/v2/"
Write-Host "2. src/data/migration/imageMapping.ts ì—…ë°ì´íŠ¸"
Write-Host "3. ProductV2 ì»´í¬ë„ŒíŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸"
`;

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const dataBlob = new Blob([script], {type: 'text/plain'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'download-productv2-images.ps1';
            link.click();
            
            alert(`PowerShell ìŠ¤í¬ë¦½íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!
            
ì‹¤í–‰ ë°©ë²•:
1. PowerShellì„ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
2. Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
3. .\\download-productv2-images.ps1

${extractedProducts.length}ê°œ ì œí’ˆì˜ ì´ë¯¸ì§€ë¥¼ í´ë” êµ¬ì¡°ì— ë§ê²Œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.`);
        }

        async function downloadAsZip() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆì„ ì¶”ì¶œí•´ì£¼ì„¸ìš”!');
                return;
            }

            // ì•ˆë‚´ ë©”ì‹œì§€
            const confirmMsg = `ZIP ë‹¤ìš´ë¡œë“œ ì‹œì‘!\n\nì£¼ì˜ì‚¬í•­:\n- CORS ì •ì±…ìœ¼ë¡œ ì¼ë¶€ ì´ë¯¸ì§€ê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n- ì‹¤íŒ¨ ì‹œ "ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±" ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”\n\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            
            if (!confirm(confirmMsg)) {
                return;
            }

            const zip = new JSZip();
            let downloadedCount = 0;
            let failedCount = 0;
            let totalCount = 0;
            
            // ì´ ì´ë¯¸ì§€ ê°œìˆ˜ ê³„ì‚°
            extractedProducts.forEach(product => {
                if (product.mainImage) totalCount++;
                if (product.instagramImage) totalCount++;
                totalCount += product.colorVariants ? product.colorVariants.length : 0;
            });

            // ì§„í–‰ ìƒí™© í‘œì‹œ
            const progressDiv = document.createElement('div');
            progressDiv.style.position = 'fixed';
            progressDiv.style.top = '50%';
            progressDiv.style.left = '50%';
            progressDiv.style.transform = 'translate(-50%, -50%)';
            progressDiv.style.background = 'white';
            progressDiv.style.padding = '20px';
            progressDiv.style.border = '2px solid #007bff';
            progressDiv.style.borderRadius = '8px';
            progressDiv.style.zIndex = '9999';
            progressDiv.style.textAlign = 'center';
            progressDiv.style.minWidth = '400px';
            progressDiv.innerHTML = `
                <h3>ğŸš€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì¤‘...</h3>
                <p id="progress-text">0/${totalCount} ì‹œë„ ì¤‘...</p>
                <div style="width: 300px; height: 20px; border: 1px solid #ccc; border-radius: 10px; overflow: hidden; margin: 10px 0;">
                    <div id="progress-bar" style="width: 0%; height: 100%; background: #007bff; transition: width 0.3s;"></div>
                </div>
                <p id="status-text"><small>ì‹œì‘ ì¤‘...</small></p>
                <button onclick="this.parentElement.remove()" style="margin-top: 10px; padding: 5px 15px; background: #dc3545; color: white; border: none; border-radius: 4px;">ì·¨ì†Œ</button>
            `;
            document.body.appendChild(progressDiv);

            // DOM ìš”ì†Œê°€ ì¶”ê°€ë  ë•Œê¹Œì§€ ì ê¹ ëŒ€ê¸°
            await new Promise(resolve => setTimeout(resolve, 100));

            // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ í—¬í¼ í•¨ìˆ˜ (í”„ë¡ì‹œ ì‚¬ìš© ì‹œë„)
            async function fetchImage(url) {
                const methods = [
                    // ë°©ë²• 1: ì§ì ‘ fetch
                    () => fetch(url, {
                        mode: 'cors',
                        headers: {
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    }),
                    // ë°©ë²• 2: no-cors ëª¨ë“œ (ì œí•œì )
                    () => fetch(url, { mode: 'no-cors' }),
                    // ë°©ë²• 3: img íƒœê·¸ë¥¼ í†µí•œ ìš°íšŒ
                    () => new Promise((resolve, reject) => {
                        const img = new Image();
                        img.crossOrigin = 'anonymous';
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            canvas.toBlob(resolve, 'image/webp', 0.9);
                        };
                        img.onerror = reject;
                        img.src = url;
                    })
                ];

                for (const method of methods) {
                    try {
                        const result = await method();
                        if (result instanceof Blob) {
                            return result;
                        } else if (result.ok) {
                            return await result.blob();
                        }
                    } catch (error) {
                        console.warn('Method failed:', error);
                    }
                }
                return null;
            }

            // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
            function updateProgress(currentUrl = '') {
                const processed = downloadedCount + failedCount;
                const percentage = Math.round((processed / totalCount) * 100);
                
                const progressText = document.getElementById('progress-text');
                const progressBar = document.getElementById('progress-bar');
                const statusText = document.getElementById('status-text');
                
                if (progressText) {
                    progressText.textContent = `${processed}/${totalCount} ì™„ë£Œ (ì„±ê³µ: ${downloadedCount}, ì‹¤íŒ¨: ${failedCount})`;
                }
                if (progressBar) {
                    progressBar.style.width = `${percentage}%`;
                }
                if (statusText) {
                    statusText.innerHTML = `<small>ì²˜ë¦¬ ì¤‘: ${currentUrl.substring(0, 60)}...</small>`;
                }
            }

            try {
                // ê° ì œí’ˆë³„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                for (const product of extractedProducts) {
                    const productFolder = product.id;

                    // ë©”ì¸ ì´ë¯¸ì§€
                    if (product.mainImage) {
                        updateProgress(product.mainImage);
                        const imageBlob = await fetchImage(product.mainImage);
                        if (imageBlob) {
                            const extension = product.mainImage.includes('.webp') ? 'webp' : 'jpg';
                            zip.folder(productFolder).folder('main').file(`${productFolder}-main.${extension}`, imageBlob);
                            downloadedCount++;
                        } else {
                            failedCount++;
                        }
                        await new Promise(resolve => setTimeout(resolve, 300));
                    }

                    // í˜¸ë²„ ì´ë¯¸ì§€
                    if (product.instagramImage) {
                        updateProgress(product.instagramImage);
                        const imageBlob = await fetchImage(product.instagramImage);
                        if (imageBlob) {
                            const extension = product.instagramImage.includes('.webp') ? 'webp' : 'jpg';
                            zip.folder(productFolder).folder('hover').file(`${productFolder}-hover.${extension}`, imageBlob);
                            downloadedCount++;
                        } else {
                            failedCount++;
                        }
                        await new Promise(resolve => setTimeout(resolve, 300));
                    }

                    // ìƒ‰ìƒ ë³€í˜•ë“¤
                    if (product.colorVariants && product.colorVariants.length > 0) {
                        for (const color of product.colorVariants) {
                            updateProgress(color.thumbnail);
                            const imageBlob = await fetchImage(color.thumbnail);
                            if (imageBlob) {
                                const extension = color.thumbnail.includes('.webp') ? 'webp' : 'jpg';
                                const colorName = color.name.toLowerCase().replace(/\s+/g, '-');
                                zip.folder(productFolder).folder('colors').file(`${productFolder}-${colorName}.${extension}`, imageBlob);
                                downloadedCount++;
                            } else {
                                failedCount++;
                            }
                            await new Promise(resolve => setTimeout(resolve, 300));
                        }
                    }
                }

                // ZIP íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
                if (downloadedCount > 0) {
                    progressDiv.innerHTML = '<h3>ğŸ“¦ ZIP íŒŒì¼ ìƒì„± ì¤‘...</h3><p>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>';
                    
                    const zipBlob = await zip.generateAsync({type: 'blob'});
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(zipBlob);
                    link.download = 'productv2-images.zip';
                    link.click();

                    // ê²°ê³¼ ë©”ì‹œì§€
                    progressDiv.innerHTML = `
                        <h3>${downloadedCount > 0 ? 'âœ…' : 'âš ï¸'} ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!</h3>
                        <p><strong>ê²°ê³¼:</strong> ${downloadedCount}ê°œ ì„±ê³µ, ${failedCount}ê°œ ì‹¤íŒ¨ (ì´ ${totalCount}ê°œ)</p>
                        ${failedCount > 0 ? '<p style="color: #dc3545;"><strong>ì‹¤íŒ¨í•œ ì´ë¯¸ì§€ê°€ ìˆìŠµë‹ˆë‹¤!</strong><br>"ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±" ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”.</p>' : ''}
                        <p><strong>í´ë” êµ¬ì¡°:</strong></p>
                        <ul style="text-align: left; display: inline-block;">
                            <li>ì œí’ˆëª…/main/ - ë©”ì¸ ì´ë¯¸ì§€</li>
                            <li>ì œí’ˆëª…/hover/ - í˜¸ë²„ ì´ë¯¸ì§€</li>
                            <li>ì œí’ˆëª…/colors/ - ìƒ‰ìƒ ë³€í˜•ë“¤</li>
                        </ul>
                        <button onclick="this.parentElement.remove()" style="margin-top: 10px; padding: 5px 15px;">ë‹«ê¸°</button>
                    `;
                } else {
                    progressDiv.innerHTML = `
                        <h3>âŒ ëª¨ë“  ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨</h3>
                        <p>CORS ì •ì±…ìœ¼ë¡œ ì¸í•´ ëª¨ë“  ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                        <p><strong>í•´ê²°ì±…:</strong> "ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±" ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                        <button onclick="this.parentElement.remove()" style="margin-top: 10px; padding: 5px 15px;">ë‹«ê¸°</button>
                    `;
                }

            } catch (error) {
                console.error('ZIP ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                progressDiv.innerHTML = `
                    <h3>âŒ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨</h3>
                    <p>ì˜¤ë¥˜: ${error.message}</p>
                    <p><strong>ëŒ€ì•ˆ:</strong> "ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±" ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                    <button onclick="this.parentElement.remove()" style="margin-top: 10px; padding: 5px 15px;">ë‹«ê¸°</button>
                `;
            }
        }

        function generateDirectDownloadLinks() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆì„ ì¶”ì¶œí•´ì£¼ì„¸ìš”!');
                return;
            }

            let html = `
                <div style="max-width: 1200px; margin: 20px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h2>ğŸ”— ì§ì ‘ ë‹¤ìš´ë¡œë“œ ë§í¬</h2>
                    <p><strong>ì‚¬ìš©ë²•:</strong> ê° ì´ë¯¸ì§€ ë§í¬ë¥¼ ìš°í´ë¦­ â†’ "ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë§í¬ ì €ì¥" â†’ ì ì ˆí•œ í´ë”ì— ì €ì¥</p>
                    <p><strong>ê¶Œì¥ í´ë” êµ¬ì¡°:</strong> <code>public/images/products/v2/ì œí’ˆëª…/main|hover|colors/</code></p>
                    <hr style="margin: 20px 0;">
            `;

            extractedProducts.forEach((product, index) => {
                html += `
                    <div style="margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">
                        <h3>ğŸ“¦ ${product.name}</h3>
                        <p><strong>ì œí’ˆ ID:</strong> <code>${product.id}</code></p>
                        <div style="margin: 15px 0;">
                `;

                // ë©”ì¸ ì´ë¯¸ì§€
                if (product.mainImage) {
                    const extension = product.mainImage.includes('.webp') ? 'webp' : 'jpg';
                    html += `
                        <div style="margin: 10px 0;">
                            <strong>ğŸ“¸ ë©”ì¸ ì´ë¯¸ì§€:</strong><br>
                            <a href="${product.mainImage}" download="${product.id}-main.${extension}" style="display: inline-block; padding: 8px 16px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; margin: 5px 0;">
                                ë‹¤ìš´ë¡œë“œ: ${product.id}-main.${extension}
                            </a>
                            <p style="font-size: 12px; color: #666; margin: 5px 0;">ì €ì¥ ìœ„ì¹˜: public/images/products/v2/${product.id}/main/</p>
                        </div>
                    `;
                }

                // í˜¸ë²„ ì´ë¯¸ì§€
                if (product.instagramImage) {
                    const extension = product.instagramImage.includes('.webp') ? 'webp' : 'jpg';
                    html += `
                        <div style="margin: 10px 0;">
                            <strong>ğŸ¯ í˜¸ë²„ ì´ë¯¸ì§€:</strong><br>
                            <a href="${product.instagramImage}" download="${product.id}-hover.${extension}" style="display: inline-block; padding: 8px 16px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; margin: 5px 0;">
                                ë‹¤ìš´ë¡œë“œ: ${product.id}-hover.${extension}
                            </a>
                            <p style="font-size: 12px; color: #666; margin: 5px 0;">ì €ì¥ ìœ„ì¹˜: public/images/products/v2/${product.id}/hover/</p>
                        </div>
                    `;
                }

                // ìƒ‰ìƒ ë³€í˜•ë“¤
                if (product.colorVariants && product.colorVariants.length > 0) {
                    html += `<div style="margin: 10px 0;"><strong>ğŸ¨ ìƒ‰ìƒ ë³€í˜•ë“¤:</strong><br>`;
                    product.colorVariants.forEach(color => {
                        const extension = color.thumbnail.includes('.webp') ? 'webp' : 'jpg';
                        const colorName = color.name.toLowerCase().replace(/\s+/g, '-');
                        html += `
                            <a href="${color.thumbnail}" download="${product.id}-${colorName}.${extension}" style="display: inline-block; padding: 6px 12px; background: #ffc107; color: black; text-decoration: none; border-radius: 4px; margin: 3px;">
                                ${color.name}
                            </a>
                        `;
                    });
                    html += `<p style="font-size: 12px; color: #666; margin: 5px 0;">ì €ì¥ ìœ„ì¹˜: public/images/products/v2/${product.id}/colors/</p></div>`;
                }

                html += '</div></div>';
            });

            html += '</div>';

            // ìƒˆ ì°½ì—ì„œ ì—´ê¸°
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html lang="ko">
                <head>
                    <meta charset="UTF-8">
                    <title>ProductV2 ì§ì ‘ ë‹¤ìš´ë¡œë“œ</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
                        a:hover { opacity: 0.8; }
                        code { background: #e9ecef; padding: 2px 4px; border-radius: 3px; }
                    </style>
                </head>
                <body>
                    ${html}
                </body>
                </html>
            `);
        }

        function generateConsoleScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆì„ ì¶”ì¶œí•´ì£¼ì„¸ìš”!');
                return;
            }

            let script = `// ğŸ¤– ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì‹¤í–‰í•  ìë™ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
// ì‚¬ìš©ë²•:
// 1. F12ë¥¼ ëˆŒëŸ¬ ê°œë°œì ë„êµ¬ ì—´ê¸°
// 2. Console íƒ­ í´ë¦­
// 3. ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê³  Enter

console.log("ğŸš€ ProductV2 ìë™ ë‹¤ìš´ë¡œë“œ ì‹œì‘!");

// ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
function downloadImage(url, filename, delay = 1000) {
    return new Promise((resolve) => {
        setTimeout(() => {
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            console.log('âœ… ë‹¤ìš´ë¡œë“œ:', filename);
            resolve();
        }, delay);
    });
}

// ë©”ì¸ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
async function downloadAllImages() {
    let count = 0;
    const total = ${extractedProducts.reduce((total, product) => {
        let count = 0;
        if (product.mainImage) count++;
        if (product.instagramImage) count++;
        count += product.colorVariants ? product.colorVariants.length : 0;
        return total + count;
    }, 0)};
    
    console.log(\`ğŸ“Š ì´ \${total}ê°œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤...\`);
`;

            extractedProducts.forEach((product, index) => {
                script += `
    // ì œí’ˆ ${index + 1}: ${product.name}
    console.log("ğŸ“¦ ì œí’ˆ ${index + 1}: ${product.name}");
`;

                // ë©”ì¸ ì´ë¯¸ì§€
                if (product.mainImage) {
                    const extension = product.mainImage.includes('.webp') ? 'webp' : 'jpg';
                    script += `    await downloadImage("${product.mainImage}", "${product.id}-main.${extension}", 1000);
    count++;
    console.log(\`ì§„í–‰ë¥ : \${count}/\${total}\`);
`;
                }

                // í˜¸ë²„ ì´ë¯¸ì§€
                if (product.instagramImage) {
                    const extension = product.instagramImage.includes('.webp') ? 'webp' : 'jpg';
                    script += `    await downloadImage("${product.instagramImage}", "${product.id}-hover.${extension}", 1000);
    count++;
    console.log(\`ì§„í–‰ë¥ : \${count}/\${total}\`);
`;
                }

                // ìƒ‰ìƒ ë³€í˜•ë“¤
                if (product.colorVariants && product.colorVariants.length > 0) {
                    product.colorVariants.forEach(color => {
                        const extension = color.thumbnail.includes('.webp') ? 'webp' : 'jpg';
                        const colorName = color.name.toLowerCase().replace(/\s+/g, '-');
                        script += `    await downloadImage("${color.thumbnail}", "${product.id}-${colorName}.${extension}", 1000);
    count++;
    console.log(\`ì§„í–‰ë¥ : \${count}/\${total}\`);
`;
                    });
                }
            });

            script += `
    console.log("ğŸ‰ ëª¨ë“  ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!");
    console.log("ğŸ“ ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ë“¤ì„ ë‹¤ìŒ í´ë” êµ¬ì¡°ë¡œ ì •ë¦¬í•˜ì„¸ìš”:");
    console.log("public/images/products/v2/");
    console.log("â”œâ”€â”€ ì œí’ˆëª…/main/ - ë©”ì¸ ì´ë¯¸ì§€");
    console.log("â”œâ”€â”€ ì œí’ˆëª…/hover/ - í˜¸ë²„ ì´ë¯¸ì§€"); 
    console.log("â””â”€â”€ ì œí’ˆëª…/colors/ - ìƒ‰ìƒ ë³€í˜•ë“¤");
}

// ë‹¤ìš´ë¡œë“œ ì‹œì‘
downloadAllImages().catch(console.error);

// ì°¸ê³ : ë¸Œë¼ìš°ì €ì—ì„œ í•œ ë²ˆì— ë„ˆë¬´ ë§ì€ ë‹¤ìš´ë¡œë“œë¥¼ í•˜ë©´ ì°¨ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
// í•„ìš”ì‹œ ìœ„ì˜ delay ê°’ì„ ëŠ˜ë ¤ì„œ ë‹¤ìš´ë¡œë“œ ê°„ê²©ì„ ì¡°ì •í•˜ì„¸ìš”.
`;

            // ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒˆ ì°½ì— í‘œì‹œ
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html lang="ko">
                <head>
                    <meta charset="UTF-8">
                    <title>ë¸Œë¼ìš°ì € ì½˜ì†” ìŠ¤í¬ë¦½íŠ¸</title>
                    <style>
                        body { font-family: 'Courier New', monospace; margin: 20px; background: #1e1e1e; color: #d4d4d4; }
                        .container { max-width: 1000px; margin: 0 auto; }
                        pre { background: #2d2d30; padding: 20px; border-radius: 8px; overflow-x: auto; border: 1px solid #3e3e42; }
                        .copy-btn { background: #007acc; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 10px 0; }
                        .copy-btn:hover { background: #005a9e; }
                        .instructions { background: #0e639c; color: white; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .warning { background: #f0ad4e; color: #8a6d3b; padding: 10px; border-radius: 4px; margin: 10px 0; }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h1>ğŸ¤– ë¸Œë¼ìš°ì € ì½˜ì†” ìë™ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸</h1>
                        
                        <div class="instructions">
                            <h3>ğŸ“‹ ì‚¬ìš©ë²•:</h3>
                            <ol>
                                <li><strong>F12</strong>ë¥¼ ëˆŒëŸ¬ ê°œë°œì ë„êµ¬ ì—´ê¸°</li>
                                <li><strong>Console</strong> íƒ­ í´ë¦­</li>
                                <li>ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ <strong>ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê³  Enter</strong></li>
                                <li>ìë™ìœ¼ë¡œ ${extractedProducts.reduce((total, product) => {
                                    let count = 0;
                                    if (product.mainImage) count++;
                                    if (product.instagramImage) count++;
                                    count += product.colorVariants ? product.colorVariants.length : 0;
                                    return total + count;
                                }, 0)}ê°œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œì‘!</li>
                            </ol>
                        </div>
                        
                        <div class="warning">
                            âš ï¸ <strong>ì£¼ì˜:</strong> ë¸Œë¼ìš°ì €ê°€ íŒì—…ì„ ì°¨ë‹¨í•˜ê±°ë‚˜ ë‹¤ìš´ë¡œë“œë¥¼ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                            í•„ìš”ì‹œ íŒì—… í—ˆìš© ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.
                        </div>
                        
                        <button class="copy-btn" onclick="copyScript()">ğŸ“‹ ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬</button>
                        
                        <pre id="script-content">${script.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
                    </div>
                    
                    <script>
                        function copyScript() {
                            const scriptContent = document.getElementById('script-content').textContent;
                            navigator.clipboard.writeText(scriptContent).then(() => {
                                alert('ìŠ¤í¬ë¦½íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\\n\\nF12 â†’ Console íƒ­ì—ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.');
                            }).catch(() => {
                                // ë³µì‚¬ ì‹¤íŒ¨ ì‹œ í…ìŠ¤íŠ¸ ì„ íƒ
                                const range = document.createRange();
                                range.selectNode(document.getElementById('script-content'));
                                window.getSelection().removeAllRanges();
                                window.getSelection().addRange(range);
                                alert('ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. Ctrl+Cë¡œ ë³µì‚¬í•˜ì„¸ìš”.');
                            });
                        }
                    </script>
                </body>
                </html>
            `);
        }

        function clearAll() {
            document.getElementById('htmlInput').value = '';
            document.getElementById('results').innerHTML = '';
            extractedProducts = [];
        }
    </script>
</body>
</html>