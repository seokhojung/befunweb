<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProductV2 ì´ë¯¸ì§€ ì¶”ì¶œê¸°</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 200px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .results {
            margin-top: 20px;
        }
        .product {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 15px;
            border-radius: 4px;
            background: #f9f9f9;
        }
        .product img {
            max-width: 200px;
            height: auto;
            margin: 5px;
            border: 1px solid #ccc;
        }
        .download-link {
            display: inline-block;
            background: #28a745;
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 3px;
            margin: 2px;
            font-size: 12px;
        }
        .download-link:hover {
            background: #1e7e34;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #007bff;
            background: #f8f9fa;
        }
        .v2-info {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 10px 0;
        }
        .color-swatches {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        .color-swatch {
            width: 40px;
            height: 40px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ–¼ï¸ ProductV2 ì´ë¯¸ì§€ ì¶”ì¶œê¸°</h1>
        <div class="v2-info">
            <h3>âœ¨ ProductV2 ìµœì í™” ê¸°ëŠ¥</h3>
            <ul>
                <li>ğŸ“ <code>public/images/products/v2/</code> êµ¬ì¡°ì— ë§ëŠ” íŒŒì¼ ì €ì¥</li>
                <li>ğŸ“ <code>bookcase-{ID}-{type}.webp</code> ë„¤ì´ë° ê·œì¹™</li>
                <li>ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ìë™ ì¶”ì¶œ</li>
                <li>ğŸ Python ìŠ¤í¬ë¦½íŠ¸ ìë™ ìƒì„±</li>
            </ul>
        </div>
        
        <div class="section">
            <h3>1ë‹¨ê³„: HTML ì½”ë“œ ì…ë ¥</h3>
            <p>product-v2-example.txt ë˜ëŠ” Tylko.com ì œí’ˆ í˜ì´ì§€ì˜ HTMLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
            <textarea id="htmlInput" placeholder="ì—¬ê¸°ì— HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
            <br>
            <button onclick="extractProducts()">ğŸ” ì œí’ˆ ì •ë³´ ì¶”ì¶œ</button>
            <button onclick="loadSampleData()">ğŸ“„ ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ</button>
            <button onclick="clearAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="section">
            <h3>2ë‹¨ê³„: ì¶”ì¶œ ê²°ê³¼</h3>
            <div id="results"></div>
        </div>
        
        <div class="section">
            <h3>3ë‹¨ê³„: ProductV2 ë‹¤ìš´ë¡œë“œ</h3>
            <button onclick="downloadV2JSON()">ğŸ“„ ProductV2 JSON</button>
            <button onclick="downloadV2CSV()">ğŸ“Š ProductV2 CSV</button>
            <button onclick="generateV2DownloadScript()">ğŸ V2 Python ìŠ¤í¬ë¦½íŠ¸</button>
            <button onclick="generateColorSwatchScript()">ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ìŠ¤í¬ë¦½íŠ¸</button>
        </div>
    </div>

    <script>
        let extractedProducts = [];

        function loadSampleData() {
            // ì‚¬ìš©ìê°€ ì œê³µí•œ ì‹¤ì œ product-v2-example.txt HTML ìƒ˜í”Œ
            const sampleHTML = `<div id="plp" class="md-max:px-0 grid-container mt-12"><ul class="grid grid-cols-2 gap-8 md:gap-16 lg:grid-cols-4" data-section="grid-v2-board"><!--[--><li data-testid="product-card"><figure class="flex flex-col h-full relative group/plp-product-card transition-all basic-transition hover:shadow-plp-product-card bg-white" data-index="0" preview="https://media.tylko.com/media/catalogue/catalogue_entry/2024/02/unreal_render_tasks/unreal_50.webp"><a href="/en-ot/furniture/bookcase/3516465,j,tall-slim-white-bookcase-with-doors-103x243x24cm" class="custom" data-testid="product-card-link"><!--[--><!--]--><!--[--><div class="relative w-full overflow-hidden aspect-square"><img src="https://media.tylko.com/media/gallery/furniture_image/2022/05/Living_room_08_living-room-Bookcase_EAPgDsY.jpg" alt="Bookcase in White with Doors" loading="eager" fetchpriority="high" class="object-cover absolute top-0 left-0" style="min-width:calc(100% + 1px);" data-testid="product-card-image-instagrid"><img src="https://media.tylko.com/media/catalogue/catalogue_entry/2024/02/unreal_render_tasks/unreal_50.webp" alt="Bookcase in White with Doors" loading="lazy" class="block group-hover/plp-product-card:opacity-100 group-hover/plp-product-card:scale-100 absolute inset-0 duration-500 ease-in-out opacity-0 transition-all z-1 transform scale-[1.04]" fetchpriority="low" style="min-width:calc(100% + 1px);" data-testid="product-card-image"><div class="semibold-12 px-8 py-2 rounded-4 absolute top-8 left-8 md:top-12 md:left-16 z-2 flex py-2 px-8" style="color:#FFFF66;background-color:#FF3C00;" data-testid="product-card-badge"><!--[-->-40% <span class="ml-4">&amp;</span><span class="ml-4">Free delivery</span><!--]--></div><!----><button class="outline-none ty-btn-icon configure-yours ty-btn-icon--m ty-btn-filled ty-btn-filled--dark hover:bg-white absolute bottom-8 lg:bottom-16 left-1/2 min-w-max -translate-x-1/2 translate-y-64 group-hover/plp-product-card:translate-y-0 md-max:translate-y-0 md-max:ty-btn-icon"></div></a><div class="flex flex-col justify-between h-full md:mt-4"><a href="/en-ot/furniture/bookcase/3516465,j,tall-slim-white-bookcase-with-doors-103x243x24cm" class="custom flex flex-col flex-1 p-8 md:p-16"><div class="flex flex-col flex-1"><p class="semibold-12 uppercase mb-8 md:mb-12 text-[#BE7958]" data-testid="product-card-label">Top seller</p><p class="semibold-14 text-neutral-900" data-testid="product-card-furniture-type">Original Modern</p><h2 class="line-clamp-1 normal-14 md:mt-2 text-neutral-750" data-testid="product-card-furniture-description">Bookcase in White with Doors</h2><h3 class="normal-14 md:mt-2 text-neutral-750" data-testid="product-card-furniture-size">103 x 243 cm</h3></div><aside class="semibold-16 text-neutral-900 mt-8 md:mt-12 text-neutral-900"><span class="semibold-16 text-orange mr-4" data-testid="product-card-price-discount">â‚¬1281</span><span class="normal-16 line-through text-neutral-900" data-testid="product-card-price">â‚¬2135</span></aside></a></div></figure></li></ul></div>`;
            
            document.getElementById('htmlInput').value = sampleHTML;
        }

        function extractProducts() {
            const htmlContent = document.getElementById('htmlInput').value;
            if (!htmlContent.trim()) {
                alert('HTML ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');
            
            const productCards = doc.querySelectorAll('[data-testid="product-card"]');
            extractedProducts = [];

            productCards.forEach((card, index) => {
                // ì œí’ˆëª… ë¨¼ì € ì¶”ì¶œ
                const nameElem = card.querySelector('[data-testid="product-card-furniture-description"]');
                const productName = nameElem ? nameElem.textContent.trim() : `Product ${index + 1}`;
                
                const product = {
                    id: generateProductFilename(productName) || `bookcase-${String(index + 1).padStart(3, '0')}`,
                    name: productName,
                    furnitureType: '',
                    exactDimensions: '',
                    mainImage: '',
                    instagramImage: '',
                    colorVariants: [],
                    discountPrice: '',
                    originalPrice: '',
                    productUrl: '',
                    labels: [],
                    badges: []
                };

                // ê°€êµ¬ íƒ€ì…
                const typeElem = card.querySelector('[data-testid="product-card-furniture-type"]');
                if (typeElem) product.furnitureType = typeElem.textContent.trim();

                // ì •í™•í•œ ì¹˜ìˆ˜
                const sizeElem = card.querySelector('[data-testid="product-card-furniture-size"]');
                if (sizeElem) product.exactDimensions = sizeElem.textContent.trim();

                // ë©”ì¸ ì´ë¯¸ì§€ (ê¸°ë³¸ í‘œì‹œë˜ëŠ” ì œí’ˆ ì´ë¯¸ì§€)
                const mainImg = card.querySelector('[data-testid="product-card-image-instagrid"]');
                if (mainImg) product.mainImage = mainImg.src || '';

                // í˜¸ë²„ ì´ë¯¸ì§€ (ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ í‘œì‹œë˜ëŠ” ì´ë¯¸ì§€) 
                const hoverImg = card.querySelector('[data-testid="product-card-image"]');
                if (hoverImg) product.instagramImage = hoverImg.src || '';

                // ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ë“¤ ì¶”ì¶œ
                const colorSwatches = card.querySelectorAll('img[src*="thumbnail"], .swatch, [class*="swatch"]');
                colorSwatches.forEach((swatch, swatchIndex) => {
                    if (swatch.src && swatch.src.includes('thumbnail')) {
                        const colorName = extractColorFromUrl(swatch.src) || `Color ${swatchIndex + 1}`;
                        product.colorVariants.push({
                            id: `${product.id}-${colorName.toLowerCase().replace(/\s+/g, '-')}`,
                            name: colorName,
                            thumbnail: swatch.src,
                            mainImage: product.mainImage,
                            instagramImage: product.instagramImage,
                            isDefault: swatchIndex === 0,
                            isSelected: swatchIndex === 0,
                            availability: 'in_stock'
                        });
                    }
                });

                // ê°€ê²© ì •ë³´
                const discountElem = card.querySelector('[data-testid="product-card-price-discount"]');
                if (discountElem) product.discountPrice = discountElem.textContent.trim();

                const originalElem = card.querySelector('[data-testid="product-card-price"]');
                if (originalElem) product.originalPrice = originalElem.textContent.trim();

                // ì œí’ˆ URL
                const linkElem = card.querySelector('[data-testid="product-card-link"]');
                if (linkElem) product.productUrl = linkElem.href || '';

                // ë¼ë²¨ë“¤
                const labelElem = card.querySelector('[data-testid="product-card-label"]');
                if (labelElem) {
                    product.labels.push({
                        text: labelElem.textContent.trim(),
                        color: '#BE7958'
                    });
                }

                // ë°°ì§€ ìƒì„± (í• ì¸ ì •ë³´ ê¸°ë°˜)
                if (product.discountPrice && product.originalPrice) {
                    product.badges.push({
                        type: 'discount',
                        text: '-40% & Free delivery',
                        style: {
                            backgroundColor: '#FF3C00',
                            color: '#FFFF66'
                        },
                        priority: 1
                    });
                }

                extractedProducts.push(product);
            });

            displayResults();
        }

        function extractColorFromUrl(url) {
            // URLì—ì„œ ìƒ‰ìƒëª… ì¶”ì¶œ ì‹œë„
            const colorKeywords = ['white', 'grey', 'brown', 'black', 'green', 'blue', 'red', 'beige', 'sand', 'pink'];
            const urlLower = url.toLowerCase();
            
            for (const color of colorKeywords) {
                if (urlLower.includes(color)) {
                    return color.charAt(0).toUpperCase() + color.slice(1);
                }
            }
            
            return null;
        }

        function generateProductFilename(productName) {
            // "Bookcase in White with Doors" â†’ "bookcase-white-doors"
            return productName
                .toLowerCase()
                .replace(/\s+in\s+/gi, '-')      // " in " â†’ "-"
                .replace(/\s+with\s+/gi, '-')    // " with " â†’ "-"  
                .replace(/\s+and\s+/gi, '-')     // " and " â†’ "-"
                .replace(/[^a-z0-9\s-]/gi, '')   // íŠ¹ìˆ˜ë¬¸ì ì œê±°
                .replace(/\s+/g, '-')            // ê³µë°± â†’ "-"
                .replace(/-+/g, '-')             // ì—°ì† í•˜ì´í”ˆ â†’ ë‹¨ì¼ í•˜ì´í”ˆ
                .replace(/^-|-$/g, '');          // ì•ë’¤ í•˜ì´í”ˆ ì œê±°
        }

        function displayResults() {
            const resultsDiv = document.getElementById('results');
            if (extractedProducts.length === 0) {
                resultsDiv.innerHTML = '<p>ì¶”ì¶œëœ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            let html = `<h4>ğŸ¯ ì´ ${extractedProducts.length}ê°œ ProductV2 ë°ì´í„° ì¶”ì¶œ ì™„ë£Œ</h4>`;
            
            extractedProducts.forEach((product, index) => {
                html += `
                <div class="product">
                    <h5>ğŸ“¦ ${product.id}: ${product.name || 'N/A'}</h5>
                    <p><strong>ğŸ·ï¸ ê°€êµ¬ íƒ€ì…:</strong> ${product.furnitureType || 'N/A'}</p>
                    <p><strong>ğŸ“ ì •í™•í•œ ì¹˜ìˆ˜:</strong> ${product.exactDimensions || 'N/A'}</p>
                    <p><strong>ğŸ’° ê°€ê²©:</strong> ${product.discountPrice || 'N/A'} <del>${product.originalPrice || ''}</del></p>
                    <p><strong>ğŸ† ë¼ë²¨:</strong> ${product.labels.map(l => l.text).join(', ') || 'N/A'}</p>
                    
                    <div>
                        <strong>ğŸ–¼ï¸ V2 ì´ë¯¸ì§€ë“¤:</strong><br>
                        ${product.mainImage ? `
                            <div>
                                <img src="${product.mainImage}" alt="ë©”ì¸ ì´ë¯¸ì§€" loading="lazy">
                                <br><a href="${product.mainImage}" class="download-link" target="_blank">Main ë‹¤ìš´ë¡œë“œ</a>
                                <small>â†’ <code>${product.id}-main.webp</code></small>
                            </div>
                        ` : ''}
                        
                        ${product.instagramImage ? `
                            <div>
                                <img src="${product.instagramImage}" alt="í˜¸ë²„ ì´ë¯¸ì§€" loading="lazy">
                                <br><a href="${product.instagramImage}" class="download-link" target="_blank">Hover ë‹¤ìš´ë¡œë“œ</a>
                                <small>â†’ <code>${product.id}-hover.webp</code></small>
                            </div>
                        ` : ''}
                        
                        ${product.colorVariants.length > 0 ? `
                            <div>
                                <p><strong>ğŸ¨ ìƒ‰ìƒ ë³€í˜• (${product.colorVariants.length}ê°œ):</strong></p>
                                <div class="color-swatches">
                                    ${product.colorVariants.map((variant, i) => `
                                        <div>
                                            <img src="${variant.thumbnail}" alt="${variant.name}" class="color-swatch">
                                            <br><small>${variant.name}</small>
                                            <br><a href="${variant.thumbnail}" class="download-link" target="_blank">ìŠ¤ì™€ì¹˜</a>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>`;
            });

            resultsDiv.innerHTML = html;
        }

        function downloadV2JSON() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            const dataStr = JSON.stringify({
                version: '2.0',
                extractedAt: new Date().toISOString(),
                totalProducts: extractedProducts.length,
                products: extractedProducts
            }, null, 2);
            
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'productv2-data.json';
            link.click();
        }

        function downloadV2CSV() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            let csv = 'ID,Name,FurnitureType,ExactDimensions,DiscountPrice,OriginalPrice,MainImageURL,InstagramImageURL,ColorVariantsCount,Labels\n';
            
            extractedProducts.forEach(product => {
                csv += `"${product.id}","${product.name}","${product.furnitureType}","${product.exactDimensions}","${product.discountPrice}","${product.originalPrice}","${product.mainImage}","${product.instagramImage}",${product.colorVariants.length},"${product.labels.map(l => l.text).join('; ')}"\n`;
            });

            const dataBlob = new Blob([csv], {type: 'text/csv'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'productv2-data.csv';
            link.click();
        }

        function generateV2DownloadScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            let script = `#!/usr/bin/env python3
# ğŸ–¼ï¸ ProductV2 ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
# BEFUN ProductV2 êµ¬ì¡°ì— ìµœì í™”ë¨

import requests
import os
import time
from pathlib import Path
from urllib.parse import urlparse

def download_image(url, filepath):
    """ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì €ì¥í•©ë‹ˆë‹¤."""
    try:
        print(f"ğŸ“¥ ë‹¤ìš´ë¡œë“œ ì¤‘: {filepath}")
        
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://tylko.com/'
        }
        
        response = requests.get(url, headers=headers, stream=True, timeout=30)
        response.raise_for_status()
        
        # ë””ë ‰í† ë¦¬ ìƒì„±
        os.makedirs(os.path.dirname(filepath), exist_ok=True)
        
        with open(filepath, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                if chunk:
                    f.write(chunk)
        
        print(f"âœ… ì™„ë£Œ: {filepath}")
        return True
        
    except Exception as e:
        print(f"âŒ ì‹¤íŒ¨ {url}: {e}")
        return False

def main():
    """ProductV2 êµ¬ì¡°ì— ë§ê²Œ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ"""
    
    # ê¸°ë³¸ ê²½ë¡œ ì„¤ì •
    base_path = Path("public/images/products/v2")
    
    # ë””ë ‰í† ë¦¬ ìƒì„±
    (base_path / "main").mkdir(parents=True, exist_ok=True)
    (base_path / "hover").mkdir(parents=True, exist_ok=True)
    (base_path / "thumbnail").mkdir(parents=True, exist_ok=True)
    
    success_count = 0
    total_count = 0
    
    print("ğŸš€ ProductV2 ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì‹œì‘...")
    print(f"ğŸ“ ì €ì¥ ìœ„ì¹˜: {base_path}")
    print()

`;

            extractedProducts.forEach((product, index) => {
                script += `    # ğŸ“¦ ${product.name}\n`;
                
                if (product.mainImage) {
                    script += `    total_count += 1\n`;
                    script += `    if download_image("${product.mainImage}", base_path / "main" / "${product.id}-main.webp"):\n`;
                    script += `        success_count += 1\n`;
                    script += `    time.sleep(0.5)\n\n`;
                }
                
                if (product.instagramImage) {
                    script += `    total_count += 1\n`;
                    script += `    if download_image("${product.instagramImage}", base_path / "hover" / "${product.id}-hover.webp"):\n`;
                    script += `        success_count += 1\n`;
                    script += `    time.sleep(0.5)\n\n`;
                }
            });

            script += `
    print()
    print("ğŸ“Š ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!")
    print(f"âœ… ì„±ê³µ: {success_count}/{total_count}")
    print(f"âŒ ì‹¤íŒ¨: {total_count - success_count}")
    print()
    print("ğŸ¯ ë‹¤ìŒ ë‹¨ê³„:")
    print("1. src/data/migration/imageMapping.ts ì—…ë°ì´íŠ¸")
    print("2. placeholder SVGë¥¼ ì‹¤ì œ WebPë¡œ êµì²´")
    print("3. ProductV2 ì»´í¬ë„ŒíŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸")

if __name__ == "__main__":
    main()
`;

            const dataBlob = new Blob([script], {type: 'text/plain'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'download_productv2_images.py';
            link.click();
        }

        function generateColorSwatchScript() {
            if (extractedProducts.length === 0) {
                alert('ë¨¼ì € ì œí’ˆ ì •ë³´ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ëª¨ë“  ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ URL ìˆ˜ì§‘
            const allSwatches = new Set();
            extractedProducts.forEach(product => {
                product.colorVariants.forEach(variant => {
                    if (variant.thumbnail) {
                        allSwatches.add(variant.thumbnail);
                    }
                });
            });

            let script = `#!/usr/bin/env python3
# ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ë‹¤ìš´ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸

import requests
import os
import time
from pathlib import Path

def download_swatch(url, filename):
    try:
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://tylko.com/'
        }
        
        response = requests.get(url, headers=headers, stream=True, timeout=30)
        response.raise_for_status()
        
        filepath = Path("public/images/products/v2/thumbnail") / filename
        os.makedirs(filepath.parent, exist_ok=True)
        
        with open(filepath, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                if chunk:
                    f.write(chunk)
        
        print(f"âœ… ìŠ¤ì™€ì¹˜ ë‹¤ìš´ë¡œë“œ: {filename}")
        return True
        
    except Exception as e:
        print(f"âŒ ì‹¤íŒ¨ {filename}: {e}")
        return False

def main():
    print("ğŸ¨ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ì¸ë„¤ì¼ ë‹¤ìš´ë¡œë“œ...")
    print()
    
`;

            Array.from(allSwatches).forEach((swatchUrl, index) => {
                const colorName = extractColorFromUrl(swatchUrl) || `swatch-${index + 1}`;
                const filename = `swatch-${colorName.toLowerCase().replace(/\s+/g, '-')}.webp`;
                
                script += `    download_swatch("${swatchUrl}", "${filename}")\n`;
                script += `    time.sleep(0.3)\n\n`;
            });

            script += `    print("ğŸ¯ ìƒ‰ìƒ ìŠ¤ì™€ì¹˜ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!")

if __name__ == "__main__":
    main()
`;

            const dataBlob = new Blob([script], {type: 'text/plain'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'download_color_swatches.py';
            link.click();
        }

        function clearAll() {
            document.getElementById('htmlInput').value = '';
            document.getElementById('results').innerHTML = '';
            extractedProducts = [];
        }
    </script>
</body>
</html>